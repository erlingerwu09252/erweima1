<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Pagesæ‘„åƒå¤´æµ‹è¯•</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-top: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        
        .status-box {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
        }
        
        .status-ready {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        .status-active {
            background: #cce5ff;
            color: #004085;
            border: 2px solid #b8daff;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            max-width: 640px;
            margin: 0 auto;
            background: #000;
            border-radius: 10px;
            overflow: hidden;
        }
        
        video {
            width: 100%;
            display: block;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 150px;
            justify-content: center;
        }
        
        .btn-start {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }
        
        .btn-start:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }
        
        .btn-stop {
            background: linear-gradient(45deg, #f44336, #da190b);
            color: white;
        }
        
        .btn-stop:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(244, 67, 54, 0.4);
        }
        
        .btn-switch {
            background: linear-gradient(45deg, #2196F3, #0b7dda);
            color: white;
        }
        
        .btn-switch:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }
        
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .instructions {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .instructions h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .instructions ol {
            margin-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .github-info {
            background: #24292e;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            button {
                min-width: 120px;
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>GitHub Pagesæ‘„åƒå¤´æµ‹è¯•</h1>
            <p class="subtitle">é€šè¿‡GitHub Pageséƒ¨ç½²çš„HTTPSé¡µé¢å¯ä»¥æ­£å¸¸è®¿é—®æ‘„åƒå¤´</p>
        </header>
        
        <div id="statusMessage" class="status-box status-ready">
            å‡†å¤‡å°±ç»ª - ç‚¹å‡»"å¼€å¯æ‘„åƒå¤´"å¼€å§‹æµ‹è¯•
        </div>
        
        <div class="video-container">
            <video id="videoElement" autoplay playsinline></video>
        </div>
        
        <div class="controls">
            <button id="startCamera" class="btn-start">
                <span>ğŸ“·</span> å¼€å¯æ‘„åƒå¤´
            </button>
            <button id="switchCamera" class="btn-switch" disabled>
                <span>ğŸ”„</span> åˆ‡æ¢æ‘„åƒå¤´
            </button>
            <button id="stopCamera" class="btn-stop" disabled>
                <span>â¹ï¸</span> åœæ­¢æ‘„åƒå¤´
            </button>
        </div>
        
        <div class="instructions">
            <h3>GitHub Pageséƒ¨ç½²è¯´æ˜</h3>
            <ol>
                <li>å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸º<code>index.html</code></li>
                <li>ä¸Šä¼ åˆ°GitHubä»“åº“</li>
                <li>åœ¨ä»“åº“è®¾ç½®ä¸­å¯ç”¨GitHub Pages</li>
                <li>é€šè¿‡<code>https://ç”¨æˆ·å.github.io/ä»“åº“å</code>è®¿é—®</li>
            </ol>
        </div>
        
        <div class="github-info">
            <strong>å½“å‰åè®®:</strong> <span id="protocolInfo">æ£€æµ‹ä¸­...</span><br>
            <strong>é¡µé¢åœ°å€:</strong> <span id="pageUrl">æ£€æµ‹ä¸­...</span>
        </div>
    </div>

    <script>
        // è·å–DOMå…ƒç´ 
        const videoElement = document.getElementById('videoElement');
        const startCameraBtn = document.getElementById('startCamera');
        const switchCameraBtn = document.getElementById('switchCamera');
        const stopCameraBtn = document.getElementById('stopCamera');
        const statusMessage = document.getElementById('statusMessage');
        const protocolInfo = document.getElementById('protocolInfo');
        const pageUrl = document.getElementById('pageUrl');
        
        // æ˜¾ç¤ºå½“å‰é¡µé¢ä¿¡æ¯
        protocolInfo.textContent = window.location.protocol;
        pageUrl.textContent = window.location.href;
        
        let stream = null;
        let currentFacingMode = 'user'; // é»˜è®¤å‰ç½®æ‘„åƒå¤´
        
        // å¼€å¯æ‘„åƒå¤´
        startCameraBtn.addEventListener('click', async () => {
            try {
                statusMessage.textContent = 'æ­£åœ¨è¯·æ±‚æ‘„åƒå¤´æƒé™...';
                statusMessage.className = 'status-box status-active';
                
                // è¯·æ±‚æ‘„åƒå¤´è®¿é—®æƒé™
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: currentFacingMode,
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    } 
                });
                
                // å°†è§†é¢‘æµç»‘å®šåˆ°videoå…ƒç´ 
                videoElement.srcObject = stream;
                
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                startCameraBtn.disabled = true;
                switchCameraBtn.disabled = false;
                stopCameraBtn.disabled = false;
                
                statusMessage.textContent = 'æ‘„åƒå¤´å·²æˆåŠŸå¼€å¯ï¼GitHub Pages HTTPSç¯å¢ƒæ­£å¸¸å·¥ä½œã€‚';
                statusMessage.className = 'status-box status-active';
                
            } catch (error) {
                console.error('æ‘„åƒå¤´è®¿é—®é”™è¯¯:', error);
                let errorMessage = 'æ— æ³•è®¿é—®æ‘„åƒå¤´: ';
                
                switch(error.name) {
                    case 'NotAllowedError':
                        errorMessage += 'ç”¨æˆ·æ‹’ç»äº†è®¿é—®æƒé™è¯·æ±‚ã€‚è¯·åˆ·æ–°é¡µé¢é‡è¯•å¹¶å…è®¸æ‘„åƒå¤´è®¿é—®ã€‚';
                        break;
                    case 'NotFoundError':
                        errorMessage += 'æœªæ‰¾åˆ°å¯ç”¨çš„æ‘„åƒå¤´è®¾å¤‡ã€‚';
                        break;
                    case 'NotSupportedError':
                        errorMessage += 'å½“å‰ç¯å¢ƒä¸æ”¯æŒæ‘„åƒå¤´è®¿é—®ã€‚GitHub Pagesåº”è¯¥æ”¯æŒï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®ã€‚';
                        break;
                    case 'NotReadableError':
                        errorMessage += 'æ‘„åƒå¤´æ­£è¢«å…¶ä»–åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                statusMessage.textContent = errorMessage;
                statusMessage.className = 'status-box status-error';
                startCameraBtn.disabled = false;
            }
        });
        
        // åˆ‡æ¢æ‘„åƒå¤´
        switchCameraBtn.addEventListener('click', () => {
            if (stream) {
                // åœæ­¢å½“å‰æµ
                stream.getTracks().forEach(track => track.stop());
                
                // åˆ‡æ¢æ‘„åƒå¤´
                currentFacingMode = currentFacingMode === 'user' ? 'environment' : 'user';
                
                // é‡æ–°å¼€å¯æ‘„åƒå¤´
                startCameraBtn.click();
            }
        });
        
        // åœæ­¢æ‘„åƒå¤´
        stopCameraBtn.addEventListener('click', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                videoElement.srcObject = null;
                stream = null;
                
                startCameraBtn.disabled = false;
                switchCameraBtn.disabled = true;
                stopCameraBtn.disabled = true;
                
                statusMessage.textContent = 'æ‘„åƒå¤´å·²å…³é—­ã€‚å¯ä»¥é‡æ–°å¼€å¯æµ‹è¯•ã€‚';
                statusMessage.className = 'status-box status-ready';
            }
        });
        
        // é¡µé¢å¸è½½å‰ç¡®ä¿å…³é—­æ‘„åƒå¤´
        window.addEventListener('beforeunload', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
        });
    </script>
</body>
</html>
